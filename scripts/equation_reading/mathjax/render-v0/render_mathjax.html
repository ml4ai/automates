<!DOCTYPE html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width">
  
  <link rel="stylesheet" href="static/css/style.css">
  
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/xml-formatter@2.1.0/dist/browser/xml-formatter.js"></script>
  <!-- <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/mml-chtml.js"></script> -->

<script>
  MathJax = {
    loader: {load: ['input/tex']}
  };
</script>

<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>

<script>
/*
function get_mml(tex_src) {
  console.log('START get_mml()');
  MathJax.texReset();
  console.log('  after texReset()');
  MathJax.tex2mmlPromise(tex_src, {display: display.checked}).then(function (mml) {
    // The promise returns the serialized MathML
    console.log('  promise succeeded');
    return mml;
  }).catch(function (err) {
    // If there was an error, put the message into the output instead
    console.log('  got error');
    console.log(err.message);
    return '';
  }).then(function () {
    // Error or not, do the following...
    console.log('END get_mml()');
  })
}
*/
</script>

</head>

<body>
  <table>
    <thead>
      <tr><th width=400>LaTeX</th><th>Equation</th><th width=500>MathML</th></tr>
    </thead>
  </table>
</body>

<script>

// const MathJax = require('mathjax');
const format_xml = require('xml-formatter');

let latex_source = [
  { src: "P(E) = {n \\choose k} p^k (1-p)^{ n-k}",
    mml: '<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"> <mi>P</mi> <mo stretchy="false">(</mo> <mi>E</mi> <mo stretchy="false">)</mo> <mo>=</mo> <mrow> <mrow data-mjx-texclass="ORD"> <mrow data-mjx-texclass="OPEN"> <mo minsize="2.047em" maxsize="2.047em">(</mo> </mrow> <mfrac linethickness="0"> <mi>n</mi> <mi>k</mi> </mfrac> <mrow data-mjx-texclass="CLOSE"> <mo minsize="2.047em" maxsize="2.047em">)</mo> </mrow> </mrow> </mrow> <msup> <mi>p</mi> <mi>k</mi> </msup> <mo stretchy="false">(</mo> <mn>1</mn> <mo>&#x2212;</mo> <mi>p</mi> <msup> <mo stretchy="false">)</mo> <mrow> <mi>n</mi> <mo>&#x2212;</mo> <mi>k</mi> </mrow> </msup> </math>' },
  { src: "\\begin{align} \\dot{x} \& = \\sigma(y-x) \\\\ \\dot{y} \& = \\rho x - y - xz \\\\ \\dot{z} \& = -\\beta z + xy \\end{align}",
    mml: '<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"> <mtable displaystyle="true" columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" rowspacing="3pt"> <mtr> <mtd> <mrow> <mover> <mi>x</mi> <mo>&#x2D9;</mo> </mover> </mrow> </mtd> <mtd> <mi></mi> <mo>=</mo> <mi>&#x3C3;</mi> <mo stretchy="false">(</mo> <mi>y</mi> <mo>&#x2212;</mo> <mi>x</mi> <mo stretchy="false">)</mo> </mtd> </mtr> <mtr> <mtd> <mrow> <mover> <mi>y</mi> <mo>&#x2D9;</mo> </mover> </mrow> </mtd> <mtd> <mi></mi> <mo>=</mo> <mi>&#x3C1;</mi> <mi>x</mi> <mo>&#x2212;</mo> <mi>y</mi> <mo>&#x2212;</mo> <mi>x</mi> <mi>z</mi> </mtd> </mtr> <mtr> <mtd> <mrow> <mover> <mi>z</mi> <mo>&#x2D9;</mo> </mover> </mrow> </mtd> <mtd> <mi></mi> <mo>=</mo> <mo>&#x2212;</mo> <mi>&#x3B2;</mi> <mi>z</mi> <mo>+</mo> <mi>x</mi> <mi>y</mi> </mtd> </mtr> </mtable> </math>' },
  { src: "\\left( \\sum_{k=1}^n a_k b_k \\right)^{\\!\\!2} \\leq \\left( \\sum_{k=1}^n a_k^2 \\right) \\left( \\sum_{k=1}^n b_k^2 \\right)",
    mml: '<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"> <msup> <mrow data-mjx-texclass="INNER"> <mo data-mjx-texclass="OPEN">(</mo> <munderover> <mo data-mjx-texclass="OP">&#x2211;</mo> <mrow> <mi>k</mi> <mo>=</mo> <mn>1</mn> </mrow> <mi>n</mi> </munderover> <msub> <mi>a</mi> <mi>k</mi> </msub> <msub> <mi>b</mi> <mi>k</mi> </msub> <mo data-mjx-texclass="CLOSE">)</mo> </mrow> <mrow> <mstyle scriptlevel="0"> <mspace width="negativethinmathspace"></mspace> </mstyle> <mstyle scriptlevel="0"> <mspace width="negativethinmathspace"></mspace> </mstyle> <mn>2</mn> </mrow> </msup> <mo>&#x2264;</mo> <mrow data-mjx-texclass="INNER"> <mo data-mjx-texclass="OPEN">(</mo> <munderover> <mo data-mjx-texclass="OP">&#x2211;</mo> <mrow> <mi>k</mi> <mo>=</mo> <mn>1</mn> </mrow> <mi>n</mi> </munderover> <msubsup> <mi>a</mi> <mi>k</mi> <mn>2</mn> </msubsup> <mo data-mjx-texclass="CLOSE">)</mo> </mrow> <mrow data-mjx-texclass="INNER"> <mo data-mjx-texclass="OPEN">(</mo> <munderover> <mo data-mjx-texclass="OP">&#x2211;</mo> <mrow> <mi>k</mi> <mo>=</mo> <mn>1</mn> </mrow> <mi>n</mi> </munderover> <msubsup> <mi>b</mi> <mi>k</mi> <mn>2</mn> </msubsup> <mo data-mjx-texclass="CLOSE">)</mo> </mrow> </math>' },
  { src: "\\mathbf{V}_1 \\times \\mathbf{V}_2 = \\begin{vmatrix} \\mathbf{i} \& \\mathbf{j} \& \\mathbf{k} \\\\ \\frac{\\partial X}{\\partial u} \& \\frac{\\partial Y}{\\partial u} \& 0 \\\\ \\frac{\\partial X}{\\partial v} \& \\frac{\\partial Y}{\\partial v} \& 0 \\\\ \\end{vmatrix}",
    mml: '<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"> <msub> <mrow> <mi mathvariant="bold">V</mi> </mrow> <mn>1</mn> </msub> <mo>&#xD7;</mo> <msub> <mrow> <mi mathvariant="bold">V</mi> </mrow> <mn>2</mn> </msub> <mo>=</mo> <mrow data-mjx-texclass="INNER"> <mo data-mjx-texclass="OPEN">|</mo> <mtable columnspacing="1em" rowspacing="4pt"> <mtr> <mtd> <mrow> <mi mathvariant="bold">i</mi> </mrow> </mtd> <mtd> <mrow> <mi mathvariant="bold">j</mi> </mrow> </mtd> <mtd> <mrow> <mi mathvariant="bold">k</mi> </mrow> </mtd> </mtr> <mtr> <mtd> <mfrac> <mrow> <mi mathvariant="normal">&#x2202;</mi> <mi>X</mi> </mrow> <mrow> <mi mathvariant="normal">&#x2202;</mi> <mi>u</mi> </mrow> </mfrac> </mtd> <mtd> <mfrac> <mrow> <mi mathvariant="normal">&#x2202;</mi> <mi>Y</mi> </mrow> <mrow> <mi mathvariant="normal">&#x2202;</mi> <mi>u</mi> </mrow> </mfrac> </mtd> <mtd> <mn>0</mn> </mtd> </mtr> <mtr> <mtd> <mfrac> <mrow> <mi mathvariant="normal">&#x2202;</mi> <mi>X</mi> </mrow> <mrow> <mi mathvariant="normal">&#x2202;</mi> <mi>v</mi> </mrow> </mfrac> </mtd> <mtd> <mfrac> <mrow> <mi mathvariant="normal">&#x2202;</mi> <mi>Y</mi> </mrow> <mrow> <mi mathvariant="normal">&#x2202;</mi> <mi>v</mi> </mrow> </mfrac> </mtd> <mtd> <mn>0</mn> </mtd> </mtr> </mtable> <mo data-mjx-texclass="CLOSE">|</mo> </mrow> </math>' },
  // { src: "\\DeclareMathOperator*{\\argmax}{arg\\,max} \\argmax_{i} (x) = \\left\\{ \\begin{array}{ll} 1 \& \\text{if } x_i = \\max_i(x) \\\\ 0 \& \\text{otherwise} \\end{array} \\right.",
  //  mml: 'TODO' },
  // { src: "\\mathbf{V}_1 \\times \\mathbf{V}_2 = " },
  // { src: "\\begin{vmatrix} \\mathbf{i} \& \\mathbf{j} \& \\mathbf{k} \\\\ \\frac{\\partial X}{\\partial u} \& \\frac{\\partial Y}{\\partial u} \& 0 \\\\ \\frac{\\partial X}{\\partial v} \& \\frac{\\partial Y}{\\partial v} \& 0 \\\\ \\end{vmatrix}" }
];


function generateTable(table, data) {
  let i = 0;
  
  for (let element of data) {
    let row = table.insertRow();
    
    let cell = row.insertCell();
    cell.id = `tex_src_${i}`;
    // let text = document.createTextNode(`\\[ ${element["src"]} \\]`);
    let text = document.createTextNode(`${element["src"]}`);
    cell.appendChild(text);
    
    // mml = MathJax.startup.toMML(element["src"]);
    // console.log(mml);
    
    // Get MathML
    // mml = get_mml(`${element["src"]}`);
    mml = `${element["mml"]}`;
    
    cell = row.insertCell();
    cell.id = `mml_img_${i}`;
    cell.innerHTML = mml;  // MathJax will render if appropriate content in innerHTML
    
    // xml-formatter options to display xml more compactly
    let mml_formatted = format_xml(mml, {
      indentation: '  ',
      collapseContent: true, 
      lineSeparator: '\n'
    });
    
    // mml_formatted = format_xml(`${element["mml"]}`);
    
    cell = row.insertCell();
    cell.id = `mml_src_${i}`;
	div_tag = document.createElement('div');
    div_tag.setAttribute('class', 'pre');
    pre_tag = document.createElement('pre');
    pre_tag.textContent = mml_formatted;
    div_tag.appendChild(pre_tag);
    cell.appendChild(div_tag);
    
    i++;
  }
}

let table = document.querySelector("table");
generateTable(table, latex_source);

</script>

</html>